telegram_control:

    automation:
    
     ## –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –≥–ª–∞–≤–Ω—ã–º –º–µ–Ω—é
      - id: –ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ç–µ–ª–µ–≥—Ä–∞–º
        alias: telegram_menu_control
        initial_state: true
        trigger:
          - platform: event
            event_type: telegram_callback
            event_data: {}
        action:
          - choose:
              - conditions:
                  - condition: template
                    value_template: '{{ trigger.event.data.command == ''/menu_hide'' }}'
                sequence:
                  - service: telegram_bot.delete_message
                    data_template:
                      message_id: '{{ trigger.event.data.message.message_id }}'
                      chat_id: '{{ trigger.event.data.chat_id }}' 
          - choose:
              - conditions:
                  - condition: template
                    value_template: '{{ trigger.event.data.command == ''/menu_back'' }}'
                sequence:
                  - service: telegram_bot.delete_message
                    data_template:
                      message_id: '{{ trigger.event.data.message.message_id }}'
                      chat_id: '{{ trigger.event.data.chat_id }}'
                  - service: telegram_bot.send_message
                    data:
                      target: "{{ trigger.event.data.chat_id }}"
                      message: |
                        {{'\U0001F527'}} *–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —É–º–Ω—ã–º –¥–æ–º–æ–º*
                        * *
                        {{'\U0001F4BB'}} *CPU* - {{ states('sensor.processor_use') }} %, {{'\U0001F321'}} - {{ states('sensor.processor_temperature') }} ¬∞C
                        {{'\U0001F6CE'}} - {{ states('alarm_control_panel.home_alarm')|replace('_', ' ') }}
                      inline_keyboard: 
                      - '{{''\U00002328''}} –¢–µ–ª–µ–º–µ—Ç—Ä–∏—è:/telemetry'
                      - '{{''\U0001F3E2''}} –ì–æ—Å—Ç–∏–Ω–∞—è:/lr_control , {{''\U0001F374''}} –ö—É—Ö–Ω—è:/kn_control'
                      - '{{''\U0001F6B6''}} –ö–æ—Ä–∏–¥–æ—Ä:/cr_control, {{''\U0001F6C0''}} –°–∞–Ω—É–∑–µ–ª:/bt_control'
                      - '{{''\U0001F9EA''}} –ë—ã—Å—Ç—Ä—ã–µ –∫–æ–º–∞–Ω–¥—ã:/hotkeys, {{''\U0001F4A1''}} –ì–∏—Ä–ª—è–Ω–¥—ã:/gl_control'
                      - '{{''\U0001F6AB''}} –£–±—Ä–∞—Ç—å –º–µ–Ω—é:/menu_hide'
  #{{'\U0001F6CE'}} - {% if is_state(''alarm_control_panel.home_alarm'', ''disarmed'')%}{{''üî¥''}}{% else %}{{''üü¢''}}{% endif %}                    

    ## –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≥–æ—Å—Ç–∏–Ω–æ–π
      - id: –ì–æ—Å—Ç–∏–Ω–∞—è –º–µ–Ω—é —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ç–µ–ª–µ–≥—Ä–∞–º
        alias: telegram_lr_menu_control
        initial_state: true
        trigger: 
          - platform: event
            event_type: telegram_callback
            event_data: {}
        action:
          - choose:
              - conditions:
                  - condition: template
                    value_template: '{{ trigger.event.data.command == ''/lr_control'' }}'
                sequence:
                  - service: telegram_bot.delete_message
                    data_template:
                      message_id: '{{ trigger.event.data.message.message_id }}'
                      chat_id: '{{ trigger.event.data.chat_id }}'
                  - service: telegram_bot.send_message
                    data:
                      target: '{{ trigger.event.data.chat_id }}'
                      message: &msg_lr |
                        {{'\U0001F3E2'}} –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≥–æ—Å—Ç–∏–Ω–æ–π :
                        {{'\U0001FA9F'}} - {% if is_state('binary_sensor.0x00158d0008e1c64f_contact', 'on') %} –û—Ç–∫—Ä—ã—Ç–æ {% else %} –ó–∞–∫—Ä—ã—Ç–æ {% endif %} 
                        {{'\U0001F321'}} - {{ states('sensor.0x00158d0008ce3df9_temperature') }} ¬∞C, {{'\U0001F4A7'}} - {{ states('sensor.0x00158d0008ce3df9_humidity') }} %
                      inline_keyboard: &keyb_lr
                        - '{{''\U0001F4A1''}} –õ–µ–Ω—Ç–∞ - {% if is_state(''switch.0x54ef441000b89402_left'', ''off'')%}{{''üî¥''}}{% elif is_state(''switch.0x54ef441000b89402_left'', ''on'')%}{{''üü¢''}}{% else %}{{''üü°''}}{% endif %}:/toggle_lr_ceiling_light_lenta , {{''\U0001F4A1''}} –õ–∞–º–ø–æ—á–∫–∏ - {% if is_state(''switch.0x54ef441000b89402_right'', ''off'')%}{{''üî¥''}}{% elif is_state(''switch.0x54ef441000b89402_right'', ''on'')%}{{''üü¢''}}{% else %}{{''üü°''}}{% endif %}:/toggle_lr_ceiling_light_lamps'
                        - '{{''\U0001F4A1''}} –ù–∞—Å—Ç–æ–ª—å–Ω–∞—è - {% if is_state(''light.lamp_1s'', ''off'')%}{{''üî¥''}}{% elif is_state(''light.lamp_1s'', ''on'')%}{{''üü¢''}}{% else %}{{''üü°''}}{% endif %}:/lr_lamp_1s_control'
                        - '{{''\U0001F4FA''}} –¢–µ–ª–µ–≤–∏–∑–æ—Ä - {% if is_state(''media_player.samsung_q60ba_55_tv'', ''off'')%}{{''üî¥''}}{% elif is_state(''media_player.samsung_q60ba_55_tv'', ''on'')%}{{''üü¢''}}{% else %}{{''üü°''}}{% endif %}:/toggle_lr_samsung, TOX - {% if is_state(''media_player.android_tv_192_168_1_150'', ''off'')%}{{''üî¥''}}{% elif is_state(''media_player.android_tv_192_168_1_150'', ''undefined'') or is_state(''media_player.android_tv_192_168_1_150'', ''unknown'')%}{{''üü°''}}{% else %}{{''üü¢''}}{% endif %}:/toggle_lr_tox'
                        - '–¢–µ—Å—Ç (–≤–µ—Å—å —Å–≤–µ—Ç):/lr_test'
                        - '{{''\U000021A9''}} –í–µ—Ä–Ω—É—Ç—å—Å—è:/menu_back , {{''\U000021AA''}} –û–±–Ω–æ–≤–∏—Ç—å:/lr_control' 

              - conditions:
                  - condition: template
                    value_template: '{{ trigger.event.data.command == ''/lr_test'' }}'
                sequence:              
                  - service: switch.toggle
                    entity_id: switch.0x54ef441000b89402_right
                  - delay:
                      milliseconds: 999
                  - service: switch.toggle
                    entity_id: switch.0x54ef441000b89402_right
                  - delay:
                      milliseconds: 999
                  - service: switch.toggle
                    entity_id: switch.0x54ef441000b89402_right
                  - delay:
                      milliseconds: 999
                  - service: switch.toggle
                    entity_id: switch.0x54ef441000b89402_right
                  - delay:
                      milliseconds: 999
                  - service: switch.toggle
                    entity_id: switch.0x54ef441000b89402_right
                  - delay:
                      milliseconds: 999
                  - service: switch.toggle
                    entity_id: switch.0x54ef441000b89402_right
                  - delay:
                      milliseconds: 999
                  - service: switch.toggle
                    entity_id: switch.0x54ef441000b89402_right
                  - delay:
                      milliseconds: 500
                  - service: telegram_bot.answer_callback_query
                    data:
                      callback_query_id: "{{ trigger.event.data.id }}"
                      message: | 
                          {{"\U0001F4AC"}} –¢–µ—Å—Ç - –∑–∞–ø—É—Å—Ç–∏–ª—Å—è
                  - service: telegram_bot.delete_message
                    data_template:
                      message_id: '{{ trigger.event.data.message.message_id }}'
                      chat_id: '{{ trigger.event.data.chat_id }}'
                  - service: telegram_bot.send_message
                    data:
                      target: '{{ trigger.event.data.chat_id }}'
                      message: *msg_lr
                      inline_keyboard: *keyb_lr


              - conditions:
                  - condition: template
                    value_template: '{{ trigger.event.data.command == ''/toggle_lr_ceiling_light_lenta'' }}'
                sequence:              
                  - service: switch.toggle
                    entity_id: switch.0x54ef441000b89402_left
                  - delay:
                      milliseconds: 500
                  - service: telegram_bot.answer_callback_query
                    data:
                      callback_query_id: "{{ trigger.event.data.id }}"
                      message: | 
                          {{"\U0001F4AC"}} –õ–µ–Ω—Ç–∞ - {% if is_state('switch.0x54ef441000b89402_left', 'on') %} –í–∫–ª—é—á–µ–Ω–∞ {% else %} –í—ã–∫–ª—é—á–µ–Ω–∞ {% endif %}
                      show_alert: false #–î–ª—è –æ—Å–æ–±–æ –≤–∞–∂–Ω—ã—Ö - –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ
                  - service: telegram_bot.delete_message
                    data_template:
                      message_id: '{{ trigger.event.data.message.message_id }}'
                      chat_id: '{{ trigger.event.data.chat_id }}'
                  - service: telegram_bot.send_message
                    data:
                      target: '{{ trigger.event.data.chat_id }}'
                      message: *msg_lr
                      inline_keyboard: *keyb_lr
                      
              - conditions:
                  - condition: template
                    value_template: '{{ trigger.event.data.command == ''/toggle_lr_ceiling_light_lamps'' }}'
                sequence:              
                  - service: switch.toggle
                    entity_id: switch.0x54ef441000b89402_right
                  - delay:
                      milliseconds: 500
                  - service: telegram_bot.answer_callback_query
                    data:
                      callback_query_id: "{{ trigger.event.data.id }}"
                      message: | 
                          {{"\U0001F4AC"}} –õ–∞–º–ø–æ—á–∫–∏ - {% if is_state('switch.0x54ef441000b89402_right', 'on') %} –í–∫–ª—é—á–µ–Ω—ã {% else %} –í—ã–∫–ª—é—á–µ–Ω—ã {% endif %}
                  - service: telegram_bot.delete_message
                    data_template:
                      message_id: '{{ trigger.event.data.message.message_id }}'
                      chat_id: '{{ trigger.event.data.chat_id }}'
                  - service: telegram_bot.send_message
                    data:
                      target: '{{ trigger.event.data.chat_id }}'
                      message: *msg_lr
                      inline_keyboard: *keyb_lr
                      
              - conditions:
                  - condition: template
                    value_template: '{{ trigger.event.data.command == ''/toggle_lr_lamp_1s'' }}'
                sequence:              
                  - service: light.toggle
                    entity_id: light.lamp_1s
                  - delay:
                      milliseconds: 500
                  - service: telegram_bot.answer_callback_query
                    data:
                      callback_query_id: "{{ trigger.event.data.id }}"
                      message: | 
                          {{"\U0001F4AC"}} –ù–∞—Å—Ç–æ–ª—å–Ω–∞—è –ª–∞–º–ø–∞ - {% if is_state('light.lamp_1s', 'on') %} –í–∫–ª—é—á–µ–Ω–∞ {% else %} –í—ã–∫–ª—é—á–µ–Ω–∞ {% endif %}
                  - service: telegram_bot.delete_message
                    data_template:
                      message_id: '{{ trigger.event.data.message.message_id }}'
                      chat_id: '{{ trigger.event.data.chat_id }}'
                  - service: telegram_bot.send_message
                    data:
                      target: '{{ trigger.event.data.chat_id }}'
                      message: *msg_lr
                      inline_keyboard: *keyb_lr
              - conditions:
                  - condition: template
                    value_template: '{{ trigger.event.data.command == ''/toggle_lr_tox'' }}'
                sequence:              
                  - service: media_player.toggle
                    target:
                        entity_id: media_player.android_tv_192_168_1_150
                  - delay:
                      milliseconds: 500
                  - service: telegram_bot.answer_callback_query
                    data:
                      callback_query_id: "{{ trigger.event.data.id }}"
                      message: | 
                          {{"\U0001F4AC"}} –û—Ç–ø—Ä–∞–≤–ª–µ–Ω–∞ –∫–æ–º–∞–Ω–¥–∞ –Ω–∞ –ø—Ä–∏—Å—Ç–∞–≤–∫—É
                  - service: telegram_bot.delete_message
                    data_template:
                      message_id: '{{ trigger.event.data.message.message_id }}'
                      chat_id: '{{ trigger.event.data.chat_id }}'
                  - service: telegram_bot.send_message
                    data:
                      target: '{{ trigger.event.data.chat_id }}'
                      message: *msg_lr
                      inline_keyboard: *keyb_lr
              - conditions:
                  - condition: template
                    value_template: '{{ trigger.event.data.command == ''/toggle_lr_samsung'' }}'
                sequence:              
                  - service: media_player.toggle
                    target:
                        entity_id: media_player.samsung_q60ba_55_tv
                  - delay:
                      milliseconds: 500
                  - service: telegram_bot.answer_callback_query
                    data:
                      callback_query_id: "{{ trigger.event.data.id }}"
                      message: | 
                          {{"\U0001F4AC"}} –û—Ç–ø—Ä–∞–≤–ª–µ–Ω–∞ –∫–æ–º–∞–Ω–¥–∞ –Ω–∞ —Ç–µ–ª–µ–≤–∏–∑–æ—Ä
                  - service: telegram_bot.delete_message
                    data_template:
                      message_id: '{{ trigger.event.data.message.message_id }}'
                      chat_id: '{{ trigger.event.data.chat_id }}'
                  - service: telegram_bot.send_message
                    data:
                      target: '{{ trigger.event.data.chat_id }}'
                      message: *msg_lr
                      inline_keyboard: *keyb_lr
                      
    ## –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫—É—Ö–Ω–µ–π
      - id: –ö—É—Ö–Ω—è –º–µ–Ω—é —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ç–µ–ª–µ–≥—Ä–∞–º
        alias: telegram_kn_menu_control
        initial_state: true
        trigger: 
          - platform: event
            event_type: telegram_callback
            event_data: {}
        action:
          - choose:
              - conditions:
                  - condition: template
                    value_template: '{{ trigger.event.data.command == ''/kn_control'' }}'
                sequence:
                  - service: telegram_bot.delete_message
                    data_template:
                      message_id: '{{ trigger.event.data.message.message_id }}'
                      chat_id: '{{ trigger.event.data.chat_id }}'
                  - service: telegram_bot.send_message
                    data:
                      target: '{{ trigger.event.data.chat_id }}'
                      message: &msg_kn |
                        {{'\U0001F374'}} –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫—É—Ö–Ω–µ–π :
                        –ö—É—Ö–Ω—è -
                        {{'\U0001F321'}} - {{ states('sensor.0xa4c1383117449f5c_temperature') }} ¬∞C, {{'\U0001F4A7'}} - {{ states('sensor.0xa4c1383117449f5c_humidity') }} %
                        {{'\U0001F6B1'}} - –†–∞–∫–æ–≤–∏–Ω–∞ - {% if is_state('binary_sensor.0x00158d0008dfa7df_water_leak', 'on') %} –ü—Ä–æ—Ç–µ—á–∫–∞ {% else %} –°—É—Ö–æ {% endif %} 
                        –ë–∞–ª–∫–æ–Ω -
                        {{'\U0001F6AA'}} - {% if is_state('binary_sensor.0xa4c1388bf2574d1e_contact', 'on') %} –û—Ç–∫—Ä—ã—Ç–∞ {% else %} –ó–∞–∫—Ä—ã—Ç–∞ {% endif %}
                        {{'\U0001F321'}} - {{ states('sensor.0x00158d0008cafd13_temperature') }} ¬∞C, {{'\U0001F4A7'}} - {{ states('sensor.0x00158d0008cafd13_humidity') }} %
                      inline_keyboard: &keyb_kn
                        - '{{''\U0001F4A1''}} –õ–µ–Ω—Ç–∞ - {% if is_state(''switch.kn_backlight_lenta'', ''off'')%}{{''üî¥''}}{% elif is_state(''switch.kn_backlight_lenta'', ''on'')%}{{''üü¢''}}{% else %}{{''üü°''}}{% endif %}:/toggle_kn_lenta , {{''\U0001F4A1''}} –ü–æ–¥—Å–≤–µ—Ç–∫–∞ - {% if is_state(''switch.kn_backlight_lamps'', ''off'')%}{{''üî¥''}}{% elif is_state(''switch.kn_backlight_lamps'', ''on'')%}{{''üü¢''}}{% else %}{{''üü°''}}{% endif %}:/toggle_kn_lamps'
                        - '{{''\U0001F4A1''}} –õ–∞–º–ø–æ—á–∫–∏ - {% if is_state(''switch.0x54ef441000aad4d8_left'', ''off'')%}{{''üî¥''}}{% elif is_state(''switch.0x54ef441000aad4d8_left'', ''on'')%}{{''üü¢''}}{% else %}{{''üü°''}}{% endif %}:/toggle_kn_ceiling_light  , {{''\U0001F4A1''}} –õ–µ–Ω—Ç–∞ –¥–ª—è —Ü–≤–µ—Ç–æ–≤ - {% if is_state(''switch.kn_led_flower'', ''off'')%}{{''üî¥''}}{% elif is_state(''switch.kn_led_flower'', ''on'')%}{{''üü¢''}}{% else %}{{''üü°''}}{% endif %}:/toggle_kn_led_flower'
                        - '{{''\U000021A9''}} –í–µ—Ä–Ω—É—Ç—å—Å—è:/menu_back , {{''\U000021AA''}} –û–±–Ω–æ–≤–∏—Ç—å:/kn_control' 
                        
              - conditions:
                  - condition: template
                    value_template: '{{ trigger.event.data.command == ''/toggle_kn_lenta'' }}'
                sequence:              
                  - service: switch.toggle
                    entity_id: switch.kn_backlight_lenta
                  - delay:
                      milliseconds: 500
                  - service: telegram_bot.answer_callback_query
                    data:
                      callback_query_id: "{{ trigger.event.data.id }}"
                      message: | 
                          {{"\U0001F4AC"}} –õ–µ–Ω—Ç–∞ - {% if is_state('switch.kn_backlight_lenta', 'on') %} –í–∫–ª—é—á–µ–Ω–∞ {% else %} –í—ã–∫–ª—é—á–µ–Ω–∞ {% endif %}
                  - service: telegram_bot.delete_message
                    data_template:
                      message_id: '{{ trigger.event.data.message.message_id }}'
                      chat_id: '{{ trigger.event.data.chat_id }}'
                  - service: telegram_bot.send_message
                    data:
                      target: '{{ trigger.event.data.chat_id }}'
                      message: *msg_kn
                      inline_keyboard: *keyb_kn
                      
              - conditions:
                  - condition: template
                    value_template: '{{ trigger.event.data.command == ''/toggle_kn_lamps'' }}'
                sequence:              
                  - service: switch.toggle
                    entity_id: switch.kn_backlight_lamps
                  - delay:
                      milliseconds: 500
                  - service: telegram_bot.answer_callback_query
                    data:
                      callback_query_id: "{{ trigger.event.data.id }}"
                      message: | 
                          {{"\U0001F4AC"}} –ü–æ–¥—Å–≤–µ—Ç–∫–∞ - {% if is_state('switch.kn_backlight_lamps', 'on') %} –í–∫–ª—é—á–µ–Ω–∞ {% else %} –í—ã–∫–ª—é—á–µ–Ω–∞ {% endif %}
                  - service: telegram_bot.delete_message
                    data_template:
                      message_id: '{{ trigger.event.data.message.message_id }}'
                      chat_id: '{{ trigger.event.data.chat_id }}'
                  - service: telegram_bot.send_message
                    data:
                      target: '{{ trigger.event.data.chat_id }}'
                      message: *msg_kn
                      inline_keyboard: *keyb_kn

              - conditions:
                  - condition: template
                    value_template: '{{ trigger.event.data.command == ''/toggle_kn_ceiling_light'' }}'
                sequence:              
                  - service: switch.toggle
                    entity_id: switch.0x54ef441000aad4d8_left
                  - delay:
                      milliseconds: 500
                  - service: telegram_bot.answer_callback_query
                    data:
                      callback_query_id: "{{ trigger.event.data.id }}"
                      message: | 
                          {{"\U0001F4AC"}} –õ–∞–º–ø–æ—á–∫–∏ - {% if is_state('switch.0x54ef441000aad4d8_left', 'on') %} –í–∫–ª—é—á–µ–Ω—ã {% else %} –í—ã–∫–ª—é—á–µ–Ω—ã {% endif %}
                  - service: telegram_bot.delete_message
                    data_template:
                      message_id: '{{ trigger.event.data.message.message_id }}'
                      chat_id: '{{ trigger.event.data.chat_id }}'
                  - service: telegram_bot.send_message
                    data:
                      target: '{{ trigger.event.data.chat_id }}'
                      message: *msg_kn
                      inline_keyboard: *keyb_kn

              - conditions:
                  - condition: template
                    value_template: '{{ trigger.event.data.command == ''/toggle_kn_led_flower'' }}'
                sequence:              
                  - service: switch.toggle
                    entity_id: switch.kn_led_flower
                  - delay:
                      milliseconds: 500
                  - service: telegram_bot.answer_callback_query
                    data:
                      callback_query_id: "{{ trigger.event.data.id }}"
                      message: | 
                          {{"\U0001F4AC"}} –õ–µ–Ω—Ç–∞ –¥–ª—è —Ü–≤–µ—Ç–æ–≤ - {% if is_state('switch.kn_led_flower', 'on') %} –í–∫–ª—é—á–µ–Ω–∞ {% else %} –í—ã–∫–ª—é—á–µ–Ω–∞ {% endif %}
                  - service: telegram_bot.delete_message
                    data_template:
                      message_id: '{{ trigger.event.data.message.message_id }}'
                      chat_id: '{{ trigger.event.data.chat_id }}'
                  - service: telegram_bot.send_message
                    data:
                      target: '{{ trigger.event.data.chat_id }}'
                      message: *msg_kn
                      inline_keyboard: *keyb_kn
                      
    ## –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–æ—Ä–∏–¥–æ—Ä–æ–º
      - id: –ö–æ—Ä–∏–¥–æ—Ä –º–µ–Ω—é —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ç–µ–ª–µ–≥—Ä–∞–º
        alias: telegram_cr_menu_control
        initial_state: true
        trigger: 
          - platform: event
            event_type: telegram_callback
            event_data: {}
        action:
          - choose:
              - conditions:
                  - condition: template
                    value_template: '{{ trigger.event.data.command == ''/cr_control'' }}'
                sequence:
                  - service: telegram_bot.delete_message
                    data_template:
                      message_id: '{{ trigger.event.data.message.message_id }}'
                      chat_id: '{{ trigger.event.data.chat_id }}'
                  - service: telegram_bot.send_message
                    data:
                      target: '{{ trigger.event.data.chat_id }}'
                      message: &msg_cr |
                        {{'\U0001F6B6'}} –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ö–æ—Ä–∏–¥–æ—Ä–æ–º :
                        * *
                        {{'\U0001F6AA'}} –í—Ö–æ–¥–Ω–∞—è –¥–≤–µ—Ä—å - {% if is_state('binary_sensor.0x00158d0008d93f0d_contact', 'on') %} –û—Ç–∫—Ä—ã—Ç–∞ {% else %} –ó–∞–∫—Ä—ã—Ç–∞ {% endif %}
                        {{'\U0001F6CE'}} - {{ states('alarm_control_panel.home_alarm')|replace('_', ' ') }}
                        {{'\U0001F321'}} - {{ states('sensor.0x00158d0008c12daf_temperature') }} ¬∞C, {{'\U0001F4A7'}} - {{ states('sensor.0x00158d0008c12daf_humidity') }} %
                        {{'\U0001F6B6'}} - {% if is_state('binary_sensor.0x00158d0008f1142d_occupancy', 'on') %} –î–≤–∏–∂–µ–Ω–∏–µ {% else %} –ù–µ—Ç –¥–≤–∏–∂–µ–Ω–∏—è {% endif %} 
                      inline_keyboard: &keyb_cr
                        - '{{''\U0001F9EA''}} –°–∏–≥–Ω–∞–ª–∏–∑–∞—Ü–∏—è:/toggle_cr_alarm'
                        - '{{''\U000021A9''}} –í–µ—Ä–Ω—É—Ç—å—Å—è:/menu_back , {{''\U000021AA''}} –û–±–Ω–æ–≤–∏—Ç—å:/cr_control' 

              - conditions:
                  - condition: template
                    value_template: '{{ trigger.event.data.command == ''/toggle_cr_alarm'' }}'
                sequence:
                  - choose:
                      - conditions:
                          - condition: state
                            entity_id: alarm_control_panel.home_alarm
                            state:
                              - 'armed_home'
                              - 'armed_away'
                              - 'pending'
                        sequence:
                          - service: alarm_control_panel.alarm_disarm
                            data:
                              entity_id: alarm_control_panel.home_alarm
                              code: !secret alarm_code
                      - conditions:
                          - condition: state
                            entity_id: alarm_control_panel.home_alarm
                            state:
                              - 'disarmed'
                        sequence:
                          - service: alarm_control_panel.alarm_arm_away
                            data:
                              entity_id: alarm_control_panel.home_alarm
                              code: !secret alarm_code                          
                  - service: telegram_bot.delete_message
                    data_template:
                      message_id: '{{ trigger.event.data.message.message_id }}'
                      chat_id: '{{ trigger.event.data.chat_id }}'
                  - service: telegram_bot.send_message
                    data:
                      target: '{{ trigger.event.data.chat_id }}'
                      message: *msg_cr
                      inline_keyboard: *keyb_cr
                      
    ## –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–∞–Ω—É–∑–µ–ª
      - id: –í–∞–Ω–Ω–∞—è –º–µ–Ω—é —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ç–µ–ª–µ–≥—Ä–∞–º
        alias: telegram_bt_menu_control
        initial_state: true
        trigger: 
          - platform: event
            event_type: telegram_callback
            event_data: {}
        action:
          - choose:
              - conditions:
                  - condition: template
                    value_template: '{{ trigger.event.data.command == ''/bt_control'' }}'
                sequence:
                  - service: telegram_bot.delete_message
                    data_template:
                      message_id: '{{ trigger.event.data.message.message_id }}'
                      chat_id: '{{ trigger.event.data.chat_id }}'
                  - service: telegram_bot.send_message
                    data:
                      target: '{{ trigger.event.data.chat_id }}'
                      message: &msg_bt |
                        {{'\U0001F6C0'}} –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤–∞–Ω–Ω–∞—è :
                        {{'\U0001F321'}} - {{ states('sensor.0x00158d0008ce3dca_temperature') }} ¬∞C, {{'\U0001F4A7'}} - {{ states('sensor.0x00158d0008ce3dca_humidity') }} %
                        {{'\U0001F6B1'}} - –°—Ç–∏—Ä–∞–ª–∫–∞ - {% if is_state('binary_sensor.0x00158d0008dfa560_water_leak', 'on') %} –ü—Ä–æ—Ç–µ—á–∫–∞ {% else %} –°—É—Ö–æ {% endif %} 
                        {{'\U0001F6AA'}} - {% if is_state('binary_sensor.0xa4c138dc68586d06_contact', 'on') %} –û—Ç–∫—Ä—ã—Ç–∞ {% else %} –ó–∞–∫—Ä—ã—Ç–∞ {% endif %}
                        {{'\U0001F6B6'}} - {% if is_state('binary_sensor.0x00158d0008f1142d_occupancy', 'on') %} –î–≤–∏–∂–µ–Ω–∏–µ {% else %} –ù–µ—Ç –¥–≤–∏–∂–µ–Ω–∏—è {% endif %} 
                      inline_keyboard: &keyb_bt
                        - '{{''\U0001F4A1''}} –õ–∞–º–ø–æ—á–∫–∏ - {% if is_state(''switch.0x54ef441000aad4d8_right'', ''off'')%}{{''üî¥''}}{% elif is_state(''switch.0x54ef441000aad4d8_right'', ''on'')%}{{''üü¢''}}{% else %}{{''üü°''}}{% endif %}:/toggle_bt_ceiling_light, {{''\U0001F4A1''}} –õ–µ–Ω—Ç–∞ - {% if is_state(''switch.0xa4c1381662c81b0e'', ''off'')%}{{''üî¥''}}{% elif is_state(''switch.0xa4c1381662c81b0e'', ''on'')%}{{''üü¢''}}{% else %}{{''üü°''}}{% endif %}:/toggle_bt_lenta_light'
                        - '{{''\U000021A9''}} –í–µ—Ä–Ω—É—Ç—å—Å—è:/menu_back , {{''\U000021AA''}} –û–±–Ω–æ–≤–∏—Ç—å:/bt_control' 

              - conditions:
                  - condition: template
                    value_template: '{{ trigger.event.data.command == ''/toggle_bt_ceiling_light'' }}'
                sequence:              
                  - service: switch.toggle
                    entity_id: switch.0x54ef441000aad4d8_right
                  - delay:
                      milliseconds: 500
                  - service: telegram_bot.answer_callback_query
                    data:
                      callback_query_id: "{{ trigger.event.data.id }}"
                      message: | 
                          {{"\U0001F4AC"}} –õ–∞–º–ø–æ—á–∫–∏ - {% if is_state('switch.0x54ef441000aad4d8_right', 'on') %} –í–∫–ª—é—á–µ–Ω—ã {% else %} –í—ã–∫–ª—é—á–µ–Ω—ã {% endif %}
                  - service: telegram_bot.delete_message
                    data_template:
                      message_id: '{{ trigger.event.data.message.message_id }}'
                      chat_id: '{{ trigger.event.data.chat_id }}'
                  - service: telegram_bot.send_message
                    data:
                      target: '{{ trigger.event.data.chat_id }}'
                      message: *msg_bt
                      inline_keyboard: *keyb_bt

              - conditions:                      
                  - condition: template
                    value_template: '{{ trigger.event.data.command == ''/toggle_bt_lenta_light'' }}'
                sequence:              
                  - service: switch.toggle
                    entity_id: switch.0xa4c1381662c81b0e
                  - delay:
                      milliseconds: 500
                  - service: telegram_bot.answer_callback_query
                    data:
                      callback_query_id: "{{ trigger.event.data.id }}"
                      message: | 
                          {{"\U0001F4AC"}} –õ–µ–Ω—Ç–∞ - {% if is_state('switch.0xa4c1381662c81b0e', 'on') %} –í–∫–ª—é—á–µ–Ω–∞ {% else %} –í—ã–∫–ª—é—á–µ–Ω–∞ {% endif %}
                  - service: telegram_bot.delete_message
                    data_template:
                      message_id: '{{ trigger.event.data.message.message_id }}'
                      chat_id: '{{ trigger.event.data.chat_id }}'
                  - service: telegram_bot.send_message
                    data:
                      target: '{{ trigger.event.data.chat_id }}'
                      message: *msg_bt
                      inline_keyboard: *keyb_bt                      

                      
    ## –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≥–∏—Ä–ª—è–Ω–¥–∞–º–∏                      
      - id: –ì–∏—Ä–ª—è–Ω–¥—ã –º–µ–Ω—é —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ç–µ–ª–µ–≥—Ä–∞–º
        alias: telegram_gl_menu_control
        initial_state: true
        trigger: 
          - platform: event
            event_type: telegram_callback
            event_data: {}
        action:
          - choose:
              - conditions:
                  - condition: template
                    value_template: '{{ trigger.event.data.command == ''/gl_control'' }}'
                sequence:
                  - service: telegram_bot.delete_message
                    data_template:
                      message_id: '{{ trigger.event.data.message.message_id }}'
                      chat_id: '{{ trigger.event.data.chat_id }}'
                  - service: telegram_bot.send_message
                    data:
                      target: '{{ trigger.event.data.chat_id }}'
                      message: &msg_gl |
                        {{'\U0001F4A1'}} –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≥–∏—Ä–ª—è–Ω–¥–∞–º–∏
                      inline_keyboard: &keyb_gl
                        - '{{''\U0001F4A1''}} –Å–ª–æ—á–∫–∏ - {% if is_state(''switch.0xa4c138323f769290'', ''off'')%}{{''üî¥''}}{% elif is_state(''switch.0xa4c138323f769290'', ''on'')%}{{''üü¢''}}{% else %}{{''üü°''}}{% endif %}:/toggle_gl_fir , {{''\U0001F4A1''}} –®—Ç–æ—Ä–∞ - {% if is_state(''switch.sonoff_10018da14e_1'', ''off'')%}{{''üî¥''}}{% elif is_state(''switch.sonoff_10018da14e_1'', ''on'')%}{{''üü¢''}}{% else %}{{''üü°''}}{% endif %}:/toggle_gl_kn_bc_curtain'
                        - '{{''\U0001F4A1''}} –§–æ–Ω–∞—Ä–∏–∫–∏ - {% if is_state(''switch.0xa4c1388af6a76f04_l4'', ''off'')%}{{''üî¥''}}{% elif is_state(''switch.0xa4c1388af6a76f04_l4'', ''on'')%}{{''üü¢''}}{% else %}{{''üü°''}}{% endif %}:/toggle_gl_lanterns , {{''\U0001F4A1''}} –î–ª–∏–Ω–Ω–∞—è - {% if is_state(''switch.0xa4c1388af6a76f04_l3'', ''off'')%}{{''üî¥''}}{% elif is_state(''switch.0xa4c1388af6a76f04_l3'', ''on'')%}{{''üü¢''}}{% else %}{{''üü°''}}{% endif %}:/toggle_gl_garland_long'
                        - '{{''\U000021A9''}} –í–µ—Ä–Ω—É—Ç—å—Å—è:/menu_back , {{''\U000021AA''}} –û–±–Ω–æ–≤–∏—Ç—å:/gl_control' 
                        
              - conditions:
                  - condition: template
                    value_template: '{{ trigger.event.data.command == ''/toggle_gl_lanterns'' }}'
                sequence:              
                  - service: switch.toggle
                    entity_id: switch.0xa4c1388af6a76f04_l4
                  - delay:
                      milliseconds: 500
                  - service: telegram_bot.answer_callback_query
                    data:
                      callback_query_id: "{{ trigger.event.data.id }}"
                      message: | 
                          {{"\U0001F4AC"}} –§–æ–Ω–∞—Ä–∏–∫–∏ - {% if is_state('switch.0xa4c1388af6a76f04_l4', 'on') %} –í–∫–ª—é—á–µ–Ω—ã {% else %} –í—ã–∫–ª—é—á–µ–Ω—ã {% endif %}
                  - service: telegram_bot.delete_message
                    data_template:
                      message_id: '{{ trigger.event.data.message.message_id }}'
                      chat_id: '{{ trigger.event.data.chat_id }}'
                  - service: telegram_bot.send_message
                    data:
                      target: '{{ trigger.event.data.chat_id }}'
                      message: *msg_gl
                      inline_keyboard: *keyb_gl

              - conditions:                      
                  - condition: template
                    value_template: '{{ trigger.event.data.command == ''/toggle_gl_fir'' }}'
                sequence:              
                  - service: switch.toggle
                    entity_id: switch.0xa4c138323f769290
                  - delay:
                      milliseconds: 500
                  - service: telegram_bot.answer_callback_query
                    data:
                      callback_query_id: "{{ trigger.event.data.id }}"
                      message: | 
                          {{"\U0001F4AC"}} –Å–ª–æ—á–∫–∏ - {% if is_state('switch.0xa4c138323f769290', 'on') %} –í–∫–ª—é—á–µ–Ω—ã {% else %} –í—ã–∫–ª—é—á–µ–Ω—ã {% endif %}
                  - service: telegram_bot.delete_message
                    data_template:
                      message_id: '{{ trigger.event.data.message.message_id }}'
                      chat_id: '{{ trigger.event.data.chat_id }}'
                  - service: telegram_bot.send_message
                    data:
                      target: '{{ trigger.event.data.chat_id }}'
                      message: *msg_gl
                      inline_keyboard: *keyb_gl
                      
              - conditions:                      
                  - condition: template
                    value_template: '{{ trigger.event.data.command == ''/toggle_gl_garland_long'' }}'
                sequence:              
                  - service: switch.toggle
                    entity_id: switch.0xa4c1388af6a76f04_l3
                  - delay:
                      milliseconds: 500
                  - service: telegram_bot.answer_callback_query
                    data:
                      callback_query_id: "{{ trigger.event.data.id }}"
                      message: | 
                          {{"\U0001F4AC"}} –Å–ª–æ—á–∫–∏ - {% if is_state('switch.0xa4c1388af6a76f04_l3', 'on') %} –í–∫–ª—é—á–µ–Ω—ã {% else %} –í—ã–∫–ª—é—á–µ–Ω—ã {% endif %}
                  - service: telegram_bot.delete_message
                    data_template:
                      message_id: '{{ trigger.event.data.message.message_id }}'
                      chat_id: '{{ trigger.event.data.chat_id }}'
                  - service: telegram_bot.send_message
                    data:
                      target: '{{ trigger.event.data.chat_id }}'
                      message: *msg_gl
                      inline_keyboard: *keyb_gl
                      
              - conditions:                      
                  - condition: template
                    value_template: '{{ trigger.event.data.command == ''/toggle_gl_kn_bc_curtain'' }}'
                sequence:              
                  - service: switch.toggle
                    entity_id: switch.sonoff_10018da14e_1
                  - delay:
                      milliseconds: 500
                  - service: telegram_bot.answer_callback_query
                    data:
                      callback_query_id: "{{ trigger.event.data.id }}"
                      message: | 
                          {{"\U0001F4AC"}} –®—Ç–æ—Ä–∞ –Ω–∞ –±–∞–ª–∫–æ–Ω–µ - {% if is_state('switch.sonoff_10018da14e_1', 'on') %} –í–∫–ª—é—á–µ–Ω–∞ {% else %} –í—ã–∫–ª—é—á–µ–Ω–∞ {% endif %}
                  - service: telegram_bot.delete_message
                    data_template:
                      message_id: '{{ trigger.event.data.message.message_id }}'
                      chat_id: '{{ trigger.event.data.chat_id }}'
                  - service: telegram_bot.send_message
                    data:
                      target: '{{ trigger.event.data.chat_id }}'
                      message: *msg_gl
                      inline_keyboard: *keyb_gl                      
                     
    ## –ë—ã—Å—Ç—Ä—ã–µ –∫–æ–º–∞–Ω–¥—ã                      
      - id: –ë—ã—Å—Ç—Ä—ã–µ –∫–æ–º–∞–Ω–¥—ã –º–µ–Ω—é —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ç–µ–ª–µ–≥—Ä–∞–º
        alias: telegram_hotkeys_control
        initial_state: true
        trigger: 
          - platform: event
            event_type: telegram_callback
            event_data: {}
        action:
          - choose:
              - conditions:
                  - condition: template
                    value_template: '{{ trigger.event.data.command == ''/hotkeys'' }}'
                sequence:
                  - service: telegram_bot.delete_message
                    data_template:
                      message_id: '{{ trigger.event.data.message.message_id }}'
                      chat_id: '{{ trigger.event.data.chat_id }}'
                  - service: telegram_bot.send_message
                    data:
                      target: '{{ trigger.event.data.chat_id }}'
                      message: &msg_hk |
                        {{'\U0001F9EA'}} –ë—ã—Å—Ç—Ä—ã–µ –∫–æ–º–∞–Ω–¥—ã
                      inline_keyboard: &keyb_hk
                        - '{{''\U0001F9EA''}} –í—Å–µ–º —Å–ø–∞—Ç—å:/toggle_hk_sleep_all'
                        - '{{''\U000021A9''}} –í–µ—Ä–Ω—É—Ç—å—Å—è:/menu_back , {{''\U000021AA''}} –û–±–Ω–æ–≤–∏—Ç—å:/hotkeys'                      
                      
                        
                        
                        
                        
                        

                        