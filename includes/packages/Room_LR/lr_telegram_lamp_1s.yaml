lr_telegram_lamp_1s:


    template:
    
      - sensor:
      
          - name: lr_lamp_1s_color
            state: >
              {% if is_state('light.lamp_1s', 'on') %}
              {{ (1000000/state_attr('light.lamp_1s', 'color_temp') ) | float |round(0)}}
              {% else %}
              –í—ã–∫–ª—é—á–µ–Ω–æ
              {% endif %}
              
          - name: lr_lamp_1s_brightness
            state: >
              {% if is_state('light.lamp_1s', 'on') %}
              {{ (state_attr('light.lamp_1s', 'brightness') / 2.55 ) | float |round(0)}}
              {% else %}
              0
              {% endif %}
              
          - name: lr_lamp_1s_effect
            state: >
              {% if is_state('light.lamp_1s', 'on') and (state_attr('light.lamp_1s', 'effect') != null) %}
              {{ state_attr('light.lamp_1s', 'effect') }}
              {% else %}
              –í—ã–∫–ª—é—á–µ–Ω–æ
              {% endif %}
              
              
    automation:

    ## –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ—Å–Ω–æ–≤–Ω—ã–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏ –ª–∞–º–ø—ã
      - id: –ù–∞—Å—Ç–æ–ª—å–Ω–∞—è –ª–∞–º–ø–∞ –≤ –≥–æ—Å—Ç–∏–Ω–æ–π
        alias: lr_telegram_lamp_1s_menu_control
        initial_state: true
        trigger: 
          - platform: event
            event_type: telegram_callback
            event_data: {}
        action:
          - choose:
              - conditions:
                  - condition: template
                    value_template: '{{ trigger.event.data.command == ''/lr_lamp_1s_control'' }}'
                sequence:
                  - service: telegram_bot.delete_message
                    data_template:
                      message_id: '{{ trigger.event.data.message.message_id }}'
                      chat_id: '{{ trigger.event.data.chat_id }}'
                  - service: telegram_bot.send_message
                    data:
                      target: '{{ trigger.event.data.chat_id }}'
                      message: &msg_lr_lamp1s |
                        {{'\U0001F4F1'}} –ì–æ—Å—Ç–∏–Ω–∞—è, –Ω–∞—Å—Ç–æ–ª—å–Ω–∞—è –ª–∞–º–ø–∞:
                        {{'\U0001F308'}} –¶–≤–µ—Ç - {{ states('sensor.lr_lamp_1s_color') }}
                        {{'\U0001F4A1'}} –Ø—Ä–∫–æ—Å—Ç—å - {{ states('sensor.lr_lamp_1s_brightness') }} %
                        {{'\U0001FA84'}} –≠—Ñ—Ñ–µ–∫—Ç - {{states('sensor.lr_lamp_1s_effect') }}
                      inline_keyboard: &keyb_lr_lamp1s
                        - '{{''\U0001F4A1''}} –õ–∞–º–ø–∞ - {% if is_state(''light.lamp_1s'', ''off'')%}{{''üî¥''}}{% elif is_state(''light.lamp_1s'', ''on'')%}{{''üü¢''}}{% else %}{{''üü°''}}{% endif %}:/toggle_lr_lamp_1s_local'
                        - '{{''\U0001F505''}} –Ø—Ä–∫–æ—Å—Ç—å -10%:/brightness_down_lamp_1s, {{''\U0001F506''}} –Ø—Ä–∫–æ—Å—Ç—å +10%:/brightness_up_lamp_1s'
                        - '{{''\U0001FA84''}} –≠—Ñ—Ñ–µ–∫—Ç—ã:/effect_lr_lamp_1s, {{''\U0001F308''}} –¶–≤–µ—Ç:/color_lr_lamp_1s'
                        - '{{''\U000021A9''}} –í–µ—Ä–Ω—É—Ç—å—Å—è:/lr_control , {{''\U000021AA''}} –û–±–Ω–æ–≤–∏—Ç—å:/lr_lamp_1s_control' 
                        
              - conditions:
                  - condition: template
                    value_template: '{{ trigger.event.data.command == ''/toggle_lr_lamp_1s_local'' }}'
                sequence:
                  - service: light.toggle
                    entity_id: light.lamp_1s
                  - delay: 00:00:01
                  - service: telegram_bot.answer_callback_query
                    data:
                      callback_query_id: "{{ trigger.event.data.id }}"
                      message: | 
                          {{"\U0001F4AC"}} –ù–∞—Å—Ç–æ–ª—å–Ω–∞—è –ª–∞–º–ø–∞ - {% if is_state('light.lamp_1s', 'on') %} –í–∫–ª—é—á–µ–Ω–∞ {% else %} –í—ã–∫–ª—é—á–µ–Ω–∞ {% endif %} 
                  - service: telegram_bot.delete_message
                    data_template:
                      message_id: '{{ trigger.event.data.message.message_id }}'
                      chat_id: '{{ trigger.event.data.chat_id }}'
                  - service: telegram_bot.send_message
                    data:
                      target: '{{ trigger.event.data.chat_id }}'
                      message: *msg_lr_lamp1s
                      inline_keyboard: *keyb_lr_lamp1s
                      
              - conditions:
                  - condition: template
                    value_template: '{{ trigger.event.data.command == ''/brightness_down_lamp_1s'' }}'
                  - condition: state
                    entity_id: light.lamp_1s
                    state: 'on'
                sequence:
                  - service: light.turn_on
                    entity_id: light.lamp_1s
                    data_template:
                      brightness_pct: > 
                        {% set brightness = states('sensor.lr_lamp_1s_brightness') | float  -10 %}
                        {% if brightness < 1 %}
                          1
                        {% else %}
                          {{ brightness }}
                        {% endif %}
                  - delay: 00:00:01
                  - service: telegram_bot.answer_callback_query
                    data:
                      callback_query_id: "{{ trigger.event.data.id }}"
                      message: | 
                          {{"\U0001F4AC"}} –¢–µ–∫—É—â–∞—è —è—Ä–∫–æ—Å—Ç—å - {{ states('sensor.lr_lamp_1s_brightness') }} %
                  - service: telegram_bot.delete_message
                    data_template:
                      message_id: '{{ trigger.event.data.message.message_id }}'
                      chat_id: '{{ trigger.event.data.chat_id }}'
                  - service: telegram_bot.send_message
                    data:
                      target: '{{ trigger.event.data.chat_id }}'
                      message: *msg_lr_lamp1s
                      inline_keyboard: *keyb_lr_lamp1s
                      
              - conditions:
                  - condition: template
                    value_template: '{{ trigger.event.data.command == ''/brightness_up_lamp_1s'' }}'
                  - condition: state
                    entity_id: light.lamp_1s
                    state: 'on'
                sequence:
                  - service: light.turn_on
                    entity_id: light.lamp_1s
                    data_template:
                      brightness_pct: > 
                        {% set brightness = states('sensor.lr_lamp_1s_brightness') | float +10 %}
                        {% if brightness > 100 %}
                          100
                        {% else %}
                          {{ brightness }}
                        {% endif %}
                  - delay: 00:00:01
                  - service: telegram_bot.answer_callback_query
                    data:
                      callback_query_id: "{{ trigger.event.data.id }}"
                      message: | 
                          {{"\U0001F4AC"}} –¢–µ–∫—É—â–∞—è —è—Ä–∫–æ—Å—Ç—å - {{ states('sensor.lr_lamp_1s_brightness') }} %
                  - service: telegram_bot.delete_message
                    data_template:
                      message_id: '{{ trigger.event.data.message.message_id }}'
                      chat_id: '{{ trigger.event.data.chat_id }}'
                  - service: telegram_bot.send_message
                    data:
                      target: '{{ trigger.event.data.chat_id }}'
                      message: *msg_lr_lamp1s
                      inline_keyboard: *keyb_lr_lamp1s

    ## –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ü–≤–µ—Ç–æ–º –ª–∞–º–ø—ã
      - id: –ù–∞—Å—Ç–æ–ª—å–Ω–∞—è –ª–∞–º–ø–∞ –º–µ–Ω—é —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ü–≤–µ—Ç–æ–º
        alias: lr_telegram_lamp_1s_color
        initial_state: true
        trigger: 
          - platform: event
            event_type: telegram_callback
            event_data: {}
        action:
          - choose:
              - conditions:
                  - condition: template
                    value_template: '{{ trigger.event.data.command == ''/color_lr_lamp_1s'' }}'
                sequence:
                  - service: telegram_bot.delete_message
                    data_template:
                      message_id: '{{ trigger.event.data.message.message_id }}'
                      chat_id: '{{ trigger.event.data.chat_id }}'
                  - service: telegram_bot.send_message
                    data:
                      target: '{{ trigger.event.data.chat_id }}'
                      message: &msg_lr_lamp1s_color |
                        {{'\U0001F4F1'}} –ì–æ—Å—Ç–∏–Ω–∞—è, –Ω–∞—Å—Ç–æ–ª—å–Ω–∞—è –ª–∞–º–ø–∞:
                        {{'\U0001F308'}} –¶–≤–µ—Ç - {{ states('sensor.lr_lamp_1s_color') }}
                        {{'\U0001F4A1'}} –Ø—Ä–∫–æ—Å—Ç—å - {{ states('sensor.lr_lamp_1s_brightness') }}
                        {{'\U0001FA84'}} –≠—Ñ—Ñ–µ–∫—Ç - {{states('sensor.lr_lamp_1s_effect') }}
                      inline_keyboard: &keyb_lr_lamp1s_color
                        - '2600 –ö:/lr_lamp_1s_2600 , 3500 –ö:/lr_lamp_1s_3500 , 4000 –ö:/lr_lamp_1s_4000 , 5000 –ö:/lr_lamp_1s_5000'
                        - '{{''\U000021A9''}} –í–µ—Ä–Ω—É—Ç—å—Å—è:/lr_lamp_1s_control , {{''\U000021AA''}} –û–±–Ω–æ–≤–∏—Ç—å:/color_lr_lamp_1s' 
                        
              - conditions:
                  - condition: template
                    value_template: '{{ trigger.event.data.command == ''/lr_lamp_1s_2600'' }}'
                sequence:
                  - service: light.turn_on
                    entity_id: light.lamp_1s
                    data:
                      color_temp: 384
                  - delay: 00:00:01
                  - service: telegram_bot.answer_callback_query
                    data:
                      callback_query_id: "{{ trigger.event.data.id }}"
                      message: | 
                          {{"\U0001F4AC"}} –ù–∞—Å—Ç–æ–ª—å–Ω–∞—è –ª–∞–º–ø–∞ - —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω —Ü–≤–µ—Ç 2600 –ö
                  - service: telegram_bot.delete_message
                    data_template:
                      message_id: '{{ trigger.event.data.message.message_id }}'
                      chat_id: '{{ trigger.event.data.chat_id }}'
                  - service: telegram_bot.send_message
                    data:
                      target: '{{ trigger.event.data.chat_id }}'
                      message: *msg_lr_lamp1s_color
                      inline_keyboard: *keyb_lr_lamp1s_color
                      
              - conditions:
                  - condition: template
                    value_template: '{{ trigger.event.data.command == ''/lr_lamp_1s_3500'' }}'
                sequence:
                  - service: light.turn_on
                    entity_id: light.lamp_1s
                    data:
                      color_temp: 286
                  - delay: 00:00:01
                  - service: telegram_bot.answer_callback_query
                    data:
                      callback_query_id: "{{ trigger.event.data.id }}"
                      message: | 
                          {{"\U0001F4AC"}} –ù–∞—Å—Ç–æ–ª—å–Ω–∞—è –ª–∞–º–ø–∞ - —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω —Ü–≤–µ—Ç 3500 –ö
                  - service: telegram_bot.delete_message
                    data_template:
                      message_id: '{{ trigger.event.data.message.message_id }}'
                      chat_id: '{{ trigger.event.data.chat_id }}'
                  - service: telegram_bot.send_message
                    data:
                      target: '{{ trigger.event.data.chat_id }}'
                      message: *msg_lr_lamp1s_color
                      inline_keyboard: *keyb_lr_lamp1s_color
                      
              - conditions:
                  - condition: template
                    value_template: '{{ trigger.event.data.command == ''/lr_lamp_1s_4000'' }}'
                sequence:
                  - service: light.turn_on
                    entity_id: light.lamp_1s
                    data:
                      color_temp: 250
                  - delay: 00:00:01
                  - service: telegram_bot.answer_callback_query
                    data:
                      callback_query_id: "{{ trigger.event.data.id }}"
                      message: | 
                          {{"\U0001F4AC"}} –ù–∞—Å—Ç–æ–ª—å–Ω–∞—è –ª–∞–º–ø–∞ - —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω —Ü–≤–µ—Ç 4000 –ö
                  - service: telegram_bot.delete_message
                    data_template:
                      message_id: '{{ trigger.event.data.message.message_id }}'
                      chat_id: '{{ trigger.event.data.chat_id }}'
                  - service: telegram_bot.send_message
                    data:
                      target: '{{ trigger.event.data.chat_id }}'
                      message: *msg_lr_lamp1s_color
                      inline_keyboard: *keyb_lr_lamp1s_color
                      
              - conditions:
                  - condition: template
                    value_template: '{{ trigger.event.data.command == ''/lr_lamp_1s_5000'' }}'
                sequence:
                  - service: light.turn_on
                    entity_id: light.lamp_1s
                    data:
                      color_temp: 200
                  - delay: 00:00:01
                  - service: telegram_bot.answer_callback_query
                    data:
                      callback_query_id: "{{ trigger.event.data.id }}"
                      message: | 
                          {{"\U0001F4AC"}} –ù–∞—Å—Ç–æ–ª—å–Ω–∞—è –ª–∞–º–ø–∞ - —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω —Ü–≤–µ—Ç 5000 –ö
                  - service: telegram_bot.delete_message
                    data_template:
                      message_id: '{{ trigger.event.data.message.message_id }}'
                      chat_id: '{{ trigger.event.data.chat_id }}'
                  - service: telegram_bot.send_message
                    data:
                      target: '{{ trigger.event.data.chat_id }}'
                      message: *msg_lr_lamp1s_color
                      inline_keyboard: *keyb_lr_lamp1s_color
                      
    ## –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —ç—Ñ—Ñ–µ–∫—Ç–∞–º–∏ –ª–∞–º–ø—ã
      - id: –ù–∞—Å—Ç–æ–ª—å–Ω–∞—è –ª–∞–º–ø–∞ –º–µ–Ω—é —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —ç—Ñ—Ñ–µ–∫—Ç–∞–º–∏
        alias: lr_telegram_lamp_1s_effect
        initial_state: true
        trigger: 
          - platform: event
            event_type: telegram_callback
            event_data: {}
        action:
          - choose:
              - conditions:
                  - condition: template
                    value_template: '{{ trigger.event.data.command == ''/effect_lr_lamp_1s'' }}'
                sequence:
                  - service: telegram_bot.delete_message
                    data_template:
                      message_id: '{{ trigger.event.data.message.message_id }}'
                      chat_id: '{{ trigger.event.data.chat_id }}'
                  - service: telegram_bot.send_message
                    data:
                      target: '{{ trigger.event.data.chat_id }}'
                      message: &msg_lr_lamp1s_effect |
                        {{'\U0001F4F1'}} –ì–æ—Å—Ç–∏–Ω–∞—è, –Ω–∞—Å—Ç–æ–ª—å–Ω–∞—è –ª–∞–º–ø–∞:
                        {{'\U0001F308'}} –¶–≤–µ—Ç - {{ states('sensor.lr_lamp_1s_color') }}
                        {{'\U0001F4A1'}} –Ø—Ä–∫–æ—Å—Ç—å - {{ states('sensor.lr_lamp_1s_brightness') }}
                        {{'\U0001FA84'}} –≠—Ñ—Ñ–µ–∫—Ç - {{states('sensor.lr_lamp_1s_effect') }}
                      inline_keyboard: &keyb_lr_lamp1s_effect
                        - 'Slow Temp:/slow_temp_lr_lamp_1s , Stop:/stop_temp_lr_lamp_1s'
                        - '{{''\U000021A9''}} –í–µ—Ä–Ω—É—Ç—å—Å—è:/lr_lamp_1s_control , {{''\U000021AA''}} –û–±–Ω–æ–≤–∏—Ç—å:/effect_lr_lamp_1s'
                        
              - conditions:
                  - condition: template
                    value_template: '{{ trigger.event.data.command == ''/slow_temp_lr_lamp_1s'' }}'
                sequence:
                  - service: light.turn_on
                    entity_id: light.lamp_1s
                    data:
                      effect: Slow Temp
                  - delay: 00:00:01
                  - service: telegram_bot.answer_callback_query
                    data:
                      callback_query_id: "{{ trigger.event.data.id }}"
                      message: | 
                          {{"\U0001F4AC"}} –ù–∞—Å—Ç–æ–ª—å–Ω–∞—è –ª–∞–º–ø–∞ - —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω —ç—Ñ—Ñ–µ–∫—Ç Slow Temp
                  - service: telegram_bot.delete_message
                    data_template:
                      message_id: '{{ trigger.event.data.message.message_id }}'
                      chat_id: '{{ trigger.event.data.chat_id }}'
                  - service: telegram_bot.send_message
                    data:
                      target: '{{ trigger.event.data.chat_id }}'
                      message: *msg_lr_lamp1s_effect
                      inline_keyboard: *keyb_lr_lamp1s_effect
                
              - conditions:
                  - condition: template
                    value_template: '{{ trigger.event.data.command == ''/stop_temp_lr_lamp_1s'' }}'
                sequence:
                  - service: light.turn_on
                    entity_id: light.lamp_1s
                    data:
                      effect: Stop
                  - delay: 00:00:01
                  - service: telegram_bot.answer_callback_query
                    data:
                      callback_query_id: "{{ trigger.event.data.id }}"
                      message: | 
                          {{"\U0001F4AC"}} –ù–∞—Å—Ç–æ–ª—å–Ω–∞—è –ª–∞–º–ø–∞ - —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω —ç—Ñ—Ñ–µ–∫—Ç Stop
                  - service: telegram_bot.delete_message
                    data_template:
                      message_id: '{{ trigger.event.data.message.message_id }}'
                      chat_id: '{{ trigger.event.data.chat_id }}'
                  - service: telegram_bot.send_message
                    data:
                      target: '{{ trigger.event.data.chat_id }}'
                      message: *msg_lr_lamp1s_effect
                      inline_keyboard: *keyb_lr_lamp1s_effect
                        
                        
                        
              